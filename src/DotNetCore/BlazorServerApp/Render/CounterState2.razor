@page "/counter-state-2"
@using System.Timers
@implements IDisposable

<h1>Counter with <code>Timer</code>disposal</h1>
<p>Current count: @currentCount</p>
@code{
    int currentCount=0;
    Timer timer = new (1000);
    protected override void OnInitialized()
    {
        timer.Elapsed+=(sender,eventArgs)=>OnTimerCallback();
        timer.Start();
        base.OnInitialized();
    }

    void OnTimerCallback()
    {
        _=InvokeAsync(()=>{
            currentCount++;
            StateHasChanged();
        });
    }

    public void Dispose()
    {
        timer.Dispose();
    }
}
